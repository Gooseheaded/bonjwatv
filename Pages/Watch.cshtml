@page
@model bwkt_webapp.Pages.WatchModel
@{
    ViewData["Title"] = Model.Video?.Title ?? "Watch";
}

@if (Model.Video == null)
{
    <div class="alert alert-danger">Video not found.</div>
}
else
{
    <h1>@Model.Video.Title</h1>
    <div class="position-relative ratio ratio-16x9 mb-3 video-wrapper">
        <iframe id="player"
                src="https://www.youtube.com/embed/@Model.Video.VideoId?enablejsapi=1"
                title="@Model.Video.Title"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
        </iframe>
        <div id="subtitle-container"
             class="position-absolute start-50 translate-middle-x subtitle-overlay">
        </div>
    </div>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="~/js/subtitles.js"></script>
    <script>
        // Initialize subtitles after the YouTube IFrame API has loaded
        initSubtitles("@Model.Video.SubtitleUrl", "player", "subtitle-container");
    </script>
}